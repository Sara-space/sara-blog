---
import { withBase as to, samePath } from '../lib/paths';
import BaseLayout from "../../layouts/BaseLayout.astro";
import Nav from "../../components/Nav.astro";
import "../../styles/global.css";
import { getCollection } from "astro:content";

const posts = (await getCollection("blog"))
  .filter(p => !p.data.draft)
  .sort((a,b) => +b.data.date - +a.data.date);
---
<BaseLayout title="Blog â€” Sara">
  <Nav />
  <main class="container-balanced pb-16">
    <h1 class="text-3xl font-extrabold mb-6">Blog</h1>
    <ul class="grid gap-4">
      {posts.map(({ id, data, slug }) => (
        <li class="card" >
          <a href={`/blog/${slug}`} class="block">
            <h3 class="text-xl font-semibold mb-1">{data.title}</h3>
            <p class="text-sm text-muted mb-2">{new Date(data.date).toLocaleDateString("es-MX")}</p>
            {data.summary && <p class="text-sm text-fg/90">{data.summary}</p>}
            {data.tags?.length ? (
              <div class="mt-3 flex flex-wrap gap-2">
                {data.tags.map((t) => <span class="text-xs px-2 py-1 rounded-xl2 bg-primary/15 border border-border/60">{t}</span>)}
              </div>
            ) : null}
          </a>
        </li>
      ))}
    </ul>
  </main>
</BaseLayout>
